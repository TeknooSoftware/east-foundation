parameters:
  teknoo.east.symfony.router.class: 'Teknoo\East\FoundationBundle\Router\Router'
  teknoo.east.symfony.listener.kernel.class: 'Teknoo\East\FoundationBundle\Listener\KernelListener'
  teknoo.east.symfony.normalizer.east_normalizer.class: 'Teknoo\East\FoundationBundle\Normalizer\EastNormalizer'

services:
  #Symfony router
  Teknoo\East\FoundationBundle\Router\Router:
    alias: 'Teknoo\East\Foundation\Router\RouterInterface'
    public: true

  Teknoo\East\Foundation\Router\RouterInterface:
    class: '%teknoo.east.symfony.router.class%'
    arguments:
      - '@router'
      - '@service_container'
    public: true

  Teknoo\East\Foundation\Manager\ManagerInterface:
    synthetic: true

  Teknoo\East\Foundation\Http\ClientInterface:
    synthetic: true

  Symfony\Bridge\PsrHttpMessage\HttpMessageFactoryInterface:
    class: 'Symfony\Bridge\PsrHttpMessage\Factory\PsrHttpFactory'
    autowire: true

  #Symfony kernel event listener
  teknoo.east.symfony.listener.kernel:
    class: '%teknoo.east.symfony.listener.kernel.class%'
    arguments:
      - '@Teknoo\East\Foundation\Manager\ManagerInterface'
      - '@Teknoo\East\Foundation\Http\ClientInterface'
      - '@Symfony\Bridge\PsrHttpMessage\HttpMessageFactoryInterface'
    tags:
      - { name: 'kernel.event_listener', event: 'kernel.request', method: 'onKernelRequest' }

  #Symfony normalizer
  teknoo.east.symfony.normalizer.east_normalizer:
    class: '%teknoo.east.symfony.normalizer.east_normalizer.class%'
    tags:
      - { name: 'serializer.normalizer', priority: 100 }

  #Laminas Support
  Teknoo\East\Diactoros\CallbackStreamFactory:
    class: 'Teknoo\East\Diactoros\CallbackStreamFactory'
